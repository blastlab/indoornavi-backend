<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
    #container {
        width: 1000px;
        height: 500px;
        background: grey;
    }

    .square {
        width: 10px;
        height: 10px;
        background: white;
        position: fixed;
    }

	#color {
		display: none;
	}
</style>
<body>
<div id="container"></div>
<select title="color" id="color">
	<option value="white">white</option>
	<option value="black">black</option>
	<option value="red">red</option>
	<option value="pink">pink</option>
	<option value="green">green</option>
</select>
</body>
<script
        src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
        crossorigin="anonymous"></script>
<script>
    $(document).ready(function () {
        var isConnectionOpen = false;
        var socket = new WebSocket("ws://localhost:80/coordinates?client");
        var message = {
            color: ''
        };
        var $container = $('#container');

        socket.onopen = function () {
            console.log('connection opened');
	        isConnectionOpen = true;
        };

        socket.onclose = function() {
        	console.log('connection closed');
        	isConnectionOpen = false;
        };

        socket.onmessage = function (msg) {
            var message = JSON.parse(msg.data);
            var $el = $('<div class="square"></div>');
            $el.css({
                'left': message.x,
                'top': message.y
            });
            $container.append($el);
        };

        var interval = null;
	    interval = setInterval(function() {
	    	console.log('waiting for connection');
        	if (isConnectionOpen) {
		        var $color = $('#color');
		        $color.change(function() {
			        message.color = $color.find('option:selected').val();
			        socket.send(JSON.stringify(message));
		        });
		        clearInterval(interval);
		        $color.show();
	        }
        }, 1000);
    });
</script>
</html>