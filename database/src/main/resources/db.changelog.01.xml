<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">
	<changeSet author="kgebert (generated)" id="issue-89-1">
		<createTable tableName="Building">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="BuildingPK"/>
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="name" type="VARCHAR(255)"/>
			<column name="complex_id" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="issue-89-2">
		<createTable tableName="Complex">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="ComplexPK"/>
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="name" type="VARCHAR(255)"/>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="issue-89-3">
		<createTable tableName="Floor">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="FloorPK"/>
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="level" type="INT"/>
			<column name="building_id" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="issue-89-7">
		<addForeignKeyConstraint baseColumnNames="complex_id" baseTableName="Building" constraintName="FK_428m38a3fvrkr0l6lt37nr7sg" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Complex"/>
	</changeSet>
	<changeSet author="kgebert (generated)" id="issue-89-8">
		<addForeignKeyConstraint baseColumnNames="building_id" baseTableName="Floor" constraintName="FK_5rv574h45qi1a16kefmy9juof" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Building"/>
	</changeSet>
	<changeSet author="pkuzmicki (generated)" id="issue-80-1">
		<createTable tableName="Anchor">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="AnchorPK"/>
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="name" type="VARCHAR(255)"/>
			<column name="shortId" type="INT"/>
			<column name="longId" type="BIGINT"/>
			<column name="x" type="DOUBLE"/>
			<column name="y" type="DOUBLE"/>
			<column name="floor_id" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet author="pkuzmicki (generated)" id="issue-80-2">
		<addForeignKeyConstraint baseColumnNames="floor_id" baseTableName="Anchor" constraintName="FK_gtwmd57hn5sf1q3c7ysdwp2db" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Floor"/>
	</changeSet>
	<changeSet author="pkuzmicki (generated)" id="issue-80-3">
		<addUniqueConstraint columnNames="shortId" constraintName="unique_shortId" tableName="Anchor"/>
	</changeSet>
	<changeSet author="pkuzmicki (generated)" id="issue-80-4">
		<addUniqueConstraint columnNames="longId" constraintName="unique_longId" tableName="Anchor"/>
	</changeSet>
	<changeSet author="kgebert (generated)" id="issue-102-1">
		<addColumn tableName="Anchor">
			<column name="verified" type="boolean"/>
		</addColumn>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-100-1">
		<addColumn tableName="Floor">
			<column name="name" type="varchar(255)"/>
		</addColumn>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-100-2">
		<addUniqueConstraint columnNames="level, building_id" constraintName="unique_level_building_id" tableName="Floor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-1">
		<createTable tableName="Device">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="DevicePK"/>
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="longId" type="BIGINT"/>
			<column name="name" type="VARCHAR(255)"/>
			<column name="shortId" type="INT"/>
			<column name="floor_id" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-2">
		<addUniqueConstraint columnNames="longId" constraintName="unique_longId" tableName="Device"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue81-3">
		<addUniqueConstraint columnNames="shortId" constraintName="unique_shortId" tableName="Device"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-4">
		<createTable tableName="Tag">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="TagPK"/>
			</column>
		</createTable>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-5">
		<addForeignKeyConstraint baseColumnNames="id" baseTableName="Tag" constraintName="FK_6yv7s5k85a0emvco4ikb6t5ps" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Device"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-6">
		<addForeignKeyConstraint baseColumnNames="id" baseTableName="Anchor" constraintName="FK_9d0jmo49iq4b14x2b91ob0w2f" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Device"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-7">
		<addForeignKeyConstraint baseColumnNames="floor_id" baseTableName="Device" constraintName="FK_gp6ktayfrcytao4bqq8vd4yms" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Floor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-8">
		<dropForeignKeyConstraint baseTableName="anchor" constraintName="FK_gtwmd57hn5sf1q3c7ysdwp2db"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-9">
		<dropUniqueConstraint constraintName="unique_longId" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-10">
		<dropUniqueConstraint constraintName="unique_shortId" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-11">
		<dropColumn columnName="creationDate" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-12">
		<dropColumn columnName="modificationDate" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-13">
		<dropColumn columnName="shortId" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-14">
		<dropColumn columnName="longId" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-15">
		<dropColumn columnName="name" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-16">
		<dropColumn columnName="floor_id" tableName="anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-17">
		<dropNotNullConstraint columnDataType="double" columnName="x" tableName="Anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-18">
		<dropNotNullConstraint columnDataType="double" columnName="y" tableName="Anchor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-19">
		<addColumn tableName="Device">
			<column name="verified" type="boolean"/>
		</addColumn>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-81-20">
		<dropColumn columnName="verified" tableName="anchor"/>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1489506078970-1">
		<createTable tableName="Coordinates">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="CoordinatesPK" />
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="device" type="VARCHAR(255)"/>
			<column name="x" type="DOUBLE"/>
			<column name="y" type="DOUBLE"/>
		</createTable>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-111-1">
		<createTable tableName="Image">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="ImagePK"/>
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="bitmap" type="BLOB"/>
			<column name="bitmapHeight" type="INT"/>
			<column name="bitmapWidth" type="INT"/>
			<column name="floor_id" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-111-2">
		<addForeignKeyConstraint baseColumnNames="floor_id" baseTableName="Image" constraintName="FK_3m9vugkgfmxx2ulfe0jb6gdye" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Floor"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-111-3">
		<addColumn tableName="Floor">
			<column name="image_id" type="bigint"/>
		</addColumn>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-111-4">
		<addForeignKeyConstraint baseColumnNames="image_id" baseTableName="Floor" constraintName="FK_6u98qhbox47qemgykogk61gt" deferrable="false"
		                         initiallyDeferred="false" referencedColumnNames="id" referencedTableName="Image"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-111-5">
		<dropForeignKeyConstraint baseTableName="image" constraintName="FK_3m9vugkgfmxx2ulfe0jb6gdye"/>
	</changeSet>
	<changeSet author="jsmol (generated)" id="issue-111-6">
		<dropColumn columnName="floor_id" tableName="image"/>
	</changeSet>
	<changeSet author="kgebert" id="issue-111-7">
		<modifyDataType tableName="image" columnName="bitmap" newDataType="mediumblob" />
	</changeSet>
	<changeSet author="kgebert (generated)" id="navi-59-1">
		<createTable tableName="Scale">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="ScalePK" />
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="measure" type="VARCHAR(255)"/>
			<column name="realDistanceInCentimeters" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="startX" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="startY" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="stopX" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="stopY" type="INT">
				<constraints nullable="false"/>
			</column>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="navi-59-2">
		<addColumn tableName="Floor">
			<column name="scale_id" type="bigint"/>
		</addColumn>
	</changeSet>
	<changeSet author="kgebert (generated)" id="navi-59-3">
		<addForeignKeyConstraint onUpdate="CASCADE" onDelete="SET NULL" baseColumnNames="scale_id" baseTableName="Floor" constraintName="FK_Floor_Scale_Id" referencedColumnNames="id" referencedTableName="Scale"/>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496754768263-1">
		<createTable tableName="Area">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="AreaPK" />
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="polygon" type="POLYGON"/>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-1">
		<createTable tableName="AreaConfiguration">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="AreaConfigurationPK" />
			</column>
			<column name="creationDate" type="timestamp"/>
			<column name="modificationDate" type="timestamp"/>
			<column name="mode" type="VARCHAR(255)"/>
			<column name="offset" type="INT"/>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-2">
		<createTable tableName="AreaConfiguration_Tag">
			<column name="areaConfiguration_id" type="BIGINT">
				<constraints nullable="false"/>
			</column>
			<column name="tags_id" type="BIGINT">
				<constraints nullable="false"/>
			</column>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-3">
		<createTable tableName="Area_AreaConfiguration">
			<column name="area_id" type="BIGINT">
				<constraints nullable="false"/>
			</column>
			<column name="configurations_id" type="BIGINT">
				<constraints nullable="false"/>
			</column>
		</createTable>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-4">
		<addColumn tableName="Area">
			<column name="name" type="varchar(255)"/>
		</addColumn>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-9">
		<addForeignKeyConstraint baseColumnNames="area_id" baseTableName="Area_AreaConfiguration" constraintName="FK_Area_AreaConfiguration_Area_Id" referencedColumnNames="id" referencedTableName="Area"/>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-10">
		<addForeignKeyConstraint baseColumnNames="tags_id" baseTableName="AreaConfiguration_Tag" constraintName="FK_AreaConfiguration_Tag_Id" referencedColumnNames="id" referencedTableName="Tag"/>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-11">
		<addForeignKeyConstraint baseColumnNames="areaConfiguration_id" baseTableName="AreaConfiguration_Tag" constraintName="FK_AreaConfiguration_Tag_AreaConfiguration_Id" referencedColumnNames="id" referencedTableName="AreaConfiguration"/>
	</changeSet>
	<changeSet author="kgebert (generated)" id="1496842280369-12">
		<addForeignKeyConstraint baseColumnNames="configurations_id" baseTableName="Area_AreaConfiguration" constraintName="FK_Area_AreaConfiguration_Configuration_Id" referencedColumnNames="id" referencedTableName="AreaConfiguration"/>
	</changeSet>
</databaseChangeLog>
